# –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞–µ—Ç:
- –ë–∞–Ω –ø–æ –ø—Ä–∏—á–∏–Ω–µ
- –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω (–Ω–∞ N –¥–Ω–µ–π)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è = –±–∞–Ω)
- –ò—Å—Ç–æ—Ä–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `users`

```python
class User(Base):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    
    # === –ú–æ–¥–µ—Ä–∞—Ü–∏—è ===
    is_blocked = Column(Boolean, default=False, index=True)
    block_type = Column(String(20))        # permanent, temporary
    block_reason = Column(String(500))
    block_expires_at = Column(DateTime)    # –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –±–∞–Ω–∞
    blocked_at = Column(DateTime)
    blocked_by = Column(Integer, ForeignKey("users.id"))
    
    warnings_count = Column(Integer, default=0)
    last_warning_at = Column(DateTime)
```

---

## –¢–∞–±–ª–∏—Ü–∞ `user_warnings`

```python
class UserWarning(Base):
    """–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    __tablename__ = "user_warnings"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)
    
    # === –ü—Ä–∏—á–∏–Ω–∞ ===
    reason = Column(String(100), nullable=False)
    # spam           - —Å–ø–∞–º
    # abuse          - –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è
    # fraud          - –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ
    # terms_violation - –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
    # other          - –¥—Ä—É–≥–æ–µ
    
    description = Column(Text)  # –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
    
    # === –ö—Ç–æ –≤—ã–¥–∞–ª ===
    issued_by = Column(Integer, ForeignKey("users.id"), nullable=False)
    
    # === –°—Ç–∞—Ç—É—Å ===
    is_active = Column(Boolean, default=True)  # False –µ—Å–ª–∏ —Å–Ω—è—Ç–æ
    revoked_at = Column(DateTime)
    revoked_by = Column(Integer, ForeignKey("users.id"))
    revoke_reason = Column(String(255))
    
    # === –ê–≤—Ç–æ–±–∞–Ω ===
    resulted_in_ban = Column(Boolean, default=False)
    
    # === Timestamps ===
    created_at = Column(DateTime, default=datetime.utcnow, index=True)
```

---

## –¢–∞–±–ª–∏—Ü–∞ `user_bans`

```python
class UserBan(Base):
    """–ò—Å—Ç–æ—Ä–∏—è –±–∞–Ω–æ–≤"""
    __tablename__ = "user_bans"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)
    
    # === –¢–∏–ø ===
    ban_type = Column(String(20), nullable=False)
    # permanent  - –Ω–∞–≤—Å–µ–≥–¥–∞
    # temporary  - –≤—Ä–µ–º–µ–Ω–Ω—ã–π
    # warning    - –∞–≤—Ç–æ–±–∞–Ω –∑–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    
    # === –ü—Ä–∏—á–∏–Ω–∞ ===
    reason = Column(String(100), nullable=False)
    description = Column(Text)
    
    # === –ü–µ—Ä–∏–æ–¥ (–¥–ª—è temporary) ===
    duration_days = Column(Integer)
    expires_at = Column(DateTime, index=True)
    
    # === –ö—Ç–æ –∑–∞–±–∞–Ω–∏–ª ===
    banned_by = Column(Integer, ForeignKey("users.id"), nullable=False)
    
    # === –†–∞–∑–±–∞–Ω ===
    is_active = Column(Boolean, default=True, index=True)
    unbanned_at = Column(DateTime)
    unbanned_by = Column(Integer, ForeignKey("users.id"))
    unban_reason = Column(String(255))
    
    # === –°–≤—è–∑—å —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ ===
    warning_ids = Column(JSON)  # [1, 2, 3] - –µ—Å–ª–∏ –∞–≤—Ç–æ–±–∞–Ω
    
    # === Timestamps ===
    created_at = Column(DateTime, default=datetime.utcnow, index=True)
```

---

## –¢–∞–±–ª–∏—Ü–∞ `moderation_log`

```python
class ModerationLog(Base):
    """–õ–æ–≥ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏"""
    __tablename__ = "moderation_log"
    
    id = Column(Integer, primary_key=True)
    
    # === –ö—Ç–æ ===
    admin_id = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)
    target_user_id = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)
    
    # === –î–µ–π—Å—Ç–≤–∏–µ ===
    action = Column(String(50), nullable=False, index=True)
    # warn              - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    # warn_revoke       - —Å–Ω—è—Ç–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    # ban_permanent     - –ø–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω—ã–π –±–∞–Ω
    # ban_temporary     - –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω
    # unban             - —Ä–∞–∑–±–∞–Ω
    # note              - –∑–∞–º–µ—Ç–∫–∞
    
    # === –î–µ—Ç–∞–ª–∏ ===
    reason = Column(String(100))
    description = Column(Text)
    duration_days = Column(Integer)
    
    # === –°–≤—è–∑–∏ ===
    warning_id = Column(Integer, ForeignKey("user_warnings.id"))
    ban_id = Column(Integer, ForeignKey("user_bans.id"))
    
    # === Timestamp ===
    created_at = Column(DateTime, default=datetime.utcnow, index=True)
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏

```python
# settings
"moderation.warnings_before_ban": 3           # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –¥–æ –∞–≤—Ç–æ–±–∞–Ω–∞
"moderation.warning_expiry_days": 30          # –ß–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "—Å–≥–æ—Ä–∞–µ—Ç"
"moderation.auto_ban_duration_days": 7        # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–±–∞–Ω–∞ –∑–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
"moderation.notify_on_warning": True          # –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–∏
"moderation.notify_on_ban": True              # –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ –±–∞–Ω–µ
"moderation.allow_appeal": True               # –†–∞–∑—Ä–µ—à–∏—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏—é
```

---

## Core API –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏

```python
async def warn_user(
    self,
    user_id: int,
    reason: str,
    description: str = None,
    admin_id: int = None
) -> WarnResult:
    """
    –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
    
    Returns:
        WarnResult:
            - success: bool
            - warning_id: int
            - warnings_count: int (—Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
            - auto_banned: bool (–µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥ –ª–∏–º–∏—Ç–∞)
            - ban_id: int (–µ—Å–ª–∏ –∑–∞–±–∞–Ω–µ–Ω)
    """

async def revoke_warning(
    self,
    warning_id: int,
    reason: str = None,
    admin_id: int = None
) -> bool:
    """–°–Ω—è—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ."""

async def ban_user(
    self,
    user_id: int,
    reason: str,
    description: str = None,
    duration_days: int = None,  # None = permanent
    admin_id: int = None
) -> BanResult:
    """
    –ó–∞–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    Args:
        duration_days: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π (None = –Ω–∞–≤—Å–µ–≥–¥–∞)
    
    Returns:
        BanResult:
            - success: bool
            - ban_id: int
            - expires_at: datetime (–¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ)
    """

async def unban_user(
    self,
    user_id: int,
    reason: str = None,
    admin_id: int = None
) -> bool:
    """–†–∞–∑–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""

async def get_user_warnings(
    self,
    user_id: int,
    active_only: bool = True
) -> list[WarningDTO]:
    """–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""

async def get_user_bans(
    self,
    user_id: int,
    active_only: bool = False
) -> list[BanDTO]:
    """–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –±–∞–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""

async def get_moderation_log(
    self,
    user_id: int = None,
    admin_id: int = None,
    action: str = None,
    limit: int = 50
) -> list[ModerationLogDTO]:
    """–ü–æ–ª—É—á–∏—Ç—å –ª–æ–≥ –º–æ–¥–µ—Ä–∞—Ü–∏–∏."""

async def check_user_banned(self, user_id: int) -> BanCheckResult:
    """
    –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–±–∞–Ω–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
    
    Returns:
        BanCheckResult:
            - is_banned: bool
            - ban_type: str
            - reason: str
            - expires_at: datetime
    """
```

---

## –ü—Ä–∏—á–∏–Ω—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏

```python
MODERATION_REASONS = {
    "spam": "–°–ø–∞–º",
    "abuse": "–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è",
    "fraud": "–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ",
    "scam": "–°–∫–∞–º",
    "terms_violation": "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª",
    "illegal_content": "–ù–µ–∑–∞–∫–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç",
    "multiple_accounts": "–ú—É–ª—å—Ç–∏–∞–∫–∫–∞—É–Ω—Ç",
    "payment_fraud": "–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏",
    "refund_abuse": "–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—Ç–∞–º–∏",
    "bot_abuse": "–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º",
    "other": "–î—Ä—É–≥–æ–µ",
}
```

---

## –ú–µ–Ω—é –∞–¥–º–∏–Ω–∞: –ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å #12345

üì± @username
üìÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: 01.01.2024
üí∞ –ë–∞–ª–∞–Ω—Å: 500 —Ç–æ–∫–µ–Ω–æ–≤
‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 1

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ö†Ô∏è –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üö´ –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚õî –ü–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω—ã–π –±–∞–Ω     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìã –ò—Å—Ç–æ—Ä–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚óÄÔ∏è –ù–∞–∑–∞–¥                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –í—ã–¥–∞—á–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

```
‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username
–¢–µ–∫—É—â–∏—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 1

–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üì¢ –°–ø–∞–º                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ü§¨ –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üö® –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìú –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚ùì –î—Ä—É–≥–æ–µ               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚óÄÔ∏è –û—Ç–º–µ–Ω–∞               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞:

```
‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

–í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username
‚Ä¢ –ü—Ä–∏—á–∏–Ω–∞: –°–ø–∞–º
‚Ä¢ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π —Å—Ç–∞–Ω–µ—Ç: 2/3

‚ö†Ô∏è –ü—Ä–∏ 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 
–±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–±–∞–Ω–µ–Ω –Ω–∞ 7 –¥–Ω–µ–π.

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚óÄÔ∏è –û—Ç–º–µ–Ω–∞               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω

```
üö´ –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username

–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ä–æ–∫:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1 –¥–µ–Ω—å                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 3 –¥–Ω—è                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 7 –¥–Ω–µ–π                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 14 –¥–Ω–µ–π                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 30 –¥–Ω–µ–π                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚óÄÔ∏è –û—Ç–º–µ–Ω–∞               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ü—Ä–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–∏

```
‚ö†Ô∏è –í–∞–º –≤—ã–¥–∞–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

–ü—Ä–∏—á–∏–Ω–∞: –°–ø–∞–º

–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 2/3

–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤–∞—à 
–∞–∫–∫–∞—É–Ω—Ç –±—É–¥–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞.
```

### –ü—Ä–∏ –±–∞–Ω–µ

```
üö´ –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

–ü—Ä–∏—á–∏–Ω–∞: –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
–°—Ä–æ–∫: 7 –¥–Ω–µ–π
–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞: 15.01.2024

–ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ —ç—Ç–æ –æ—à–∏–±–∫–æ–π, 
–æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.
```

### –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–µ–π—Å—Ç–≤–∏—è (–∑–∞–±–∞–Ω–µ–Ω)

```
üö´ –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

–ü—Ä–∏—á–∏–Ω–∞: –°–ø–∞–º
–î–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: 5 –¥–Ω–µ–π

–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –µ—Å–ª–∏ —Å—á–∏—Ç–∞–µ—Ç–µ 
—ç—Ç–æ –æ—à–∏–±–∫–æ–π.

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üì© –ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```python
# –í middleware/—Ö–µ–Ω–¥–ª–µ—Ä–∞—Ö

async def check_user_access(user_id: int) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –ª—é–±—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º"""
    
    ban_check = await core.check_user_banned(user_id)
    
    if ban_check.is_banned:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∏—Å—Ç—ë–∫ –ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω
        if ban_check.expires_at and ban_check.expires_at < datetime.utcnow():
            await core.unban_user(user_id, reason="–°—Ä–æ–∫ –±–∞–Ω–∞ –∏—Å—Ç—ë–∫")
            return True
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –±–∞–Ω–µ
        await show_ban_message(user_id, ban_check)
        return False
    
    return True
```

---

## –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

```python
# core/locales/ru.py

MODERATION = {
    # –ü—Ä–∏—á–∏–Ω—ã
    "reason_spam": "–°–ø–∞–º",
    "reason_abuse": "–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è",
    "reason_fraud": "–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ",
    "reason_terms_violation": "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª",
    "reason_other": "–î—Ä—É–≥–æ–µ",
    
    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    "warning_issued": "‚ö†Ô∏è –í–∞–º –≤—ã–¥–∞–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ",
    "warning_reason": "–ü—Ä–∏—á–∏–Ω–∞: {reason}",
    "warning_count": "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {current}/{max}",
    "warning_notice": "–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ {max} –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –±—É–¥–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.",
    
    # –ë–∞–Ω
    "banned_title": "üö´ –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
    "banned_reason": "–ü—Ä–∏—á–∏–Ω–∞: {reason}",
    "banned_permanent": "–°—Ä–æ–∫: –Ω–∞–≤—Å–µ–≥–¥–∞",
    "banned_temporary": "–°—Ä–æ–∫: {days} –¥–Ω–µ–π",
    "banned_until": "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞: {date}",
    "banned_days_left": "–î–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: {days} –¥–Ω–µ–π",
    "banned_appeal": "–ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ —ç—Ç–æ –æ—à–∏–±–∫–æ–π, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.",
    
    # –†–∞–∑–±–∞–Ω
    "unbanned": "‚úÖ –í–∞—à –∞–∫–∫–∞—É–Ω—Ç —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
    
    # –ê–¥–º–∏–Ω–∫–∞
    "admin_warn": "‚ö†Ô∏è –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ",
    "admin_ban_temp": "üö´ –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω",
    "admin_ban_perm": "‚õî –ü–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω—ã–π –±–∞–Ω",
    "admin_unban": "‚úÖ –†–∞–∑–±–∞–Ω–∏—Ç—å",
    "admin_history": "üìã –ò—Å—Ç–æ—Ä–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏",
}
```
